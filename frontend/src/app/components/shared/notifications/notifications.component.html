<div class="notifications-container" (clickOutside)="onOutsideClick($event)">
  <!-- Bot√≥n de notificaciones -->
  <button
    class="notification-button"
    (click)="toggleDropdown()"
    [class.has-notifications]="unreadCount > 0"
    title="Notificaciones"
  >
    <div class="notification-icon">
      üîî
    </div>

    <!-- Badge de notificaciones no le√≠das -->
    <div *ngIf="unreadCount > 0" class="notification-badge">
      {{ unreadCount > 99 ? '99+' : unreadCount }}
    </div>
  </button>

  <!-- Dropdown de notificaciones -->
  <div *ngIf="showDropdown" class="notifications-dropdown">
    <!-- Header del dropdown -->
    <div class="dropdown-header">
      <h3>Notificaciones</h3>
      <div class="header-actions">
        <button
          *ngIf="unreadCount > 0"
          class="mark-all-read-btn"
          (click)="markAllAsRead()"
          title="Marcar todas como le√≠das"
        >
          ‚úì
        </button>
        <button
          *ngIf="notifications.length > 0"
          class="clear-all-btn"
          (click)="clearAllNotifications()"
          title="Limpiar todas"
        >
          üóëÔ∏è
        </button>
      </div>
    </div>

    <!-- Lista de notificaciones -->
    <div class="notifications-list">
      <div *ngIf="notifications.length === 0" class="no-notifications">
        <div class="no-notifications-icon">üì≠</div>
        <p>No tienes notificaciones</p>
      </div>

      <div
        *ngFor="let notification of notifications; trackBy: trackByNotificationId"
        class="notification-item"
        [class.unread]="!notification.read"
        [class.clickable]="!!notification.actionUrl"
        (click)="onNotificationClick(notification)"
      >
        <div class="notification-content">
          <div class="notification-header">
            <span class="notification-icon-small">
              {{ getNotificationIcon(notification.type) }}
            </span>
            <span class="notification-title">{{ notification.title }}</span>
            <span class="notification-time">{{ formatTime(notification.timestamp) }}</span>
          </div>

          <div class="notification-message">
            {{ notification.message }}
          </div>

          <div *ngIf="notification.ticketId" class="notification-ticket">
            Ticket #{{ notification.ticketId }}
          </div>
        </div>

        <div class="notification-actions">
          <button
            *ngIf="!notification.read"
            class="mark-read-btn"
            (click)="markAsRead(notification); $event.stopPropagation()"
            title="Marcar como le√≠da"
          >
            ‚úì
          </button>

          <button
            class="remove-btn"
            (click)="removeNotification(notification.id); $event.stopPropagation()"
            title="Eliminar notificaci√≥n"
          >
            ‚úï
          </button>
        </div>
      </div>
    </div>

    <!-- Bot√≥n de prueba para simular cambio de estado -->

    <!-- Footer del dropdown -->
    <div *ngIf="notifications.length > 0" class="dropdown-footer">
      <small>{{ notifications.length }} notificaci√≥n(es) total</small>
    </div>
  </div>
</div>

